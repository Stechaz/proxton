<?xml version="1.0" encoding="utf-8"?>
<odoo noupdate="1">

    <!-- Portal Access Rules for Stock Picking -->
    <record id="stock_picking_rule_portal" model="ir.rule">
        <field name="name">Portal Personal Deliveries</field>
        <field name="model_id" ref="stock.model_stock_picking"/>
        <field name="domain_force">[
            ('partner_id', 'child_of', [user.commercial_partner_id.id]),
            ('picking_type_id.code', '=', 'outgoing'),
            ('state', '=', 'done')
        ]</field>
        <field name="groups" eval="[(4, ref('base.group_portal'))]"/>
        <field name="perm_read" eval="True"/>
        <field name="perm_write" eval="False"/>
        <field name="perm_create" eval="False"/>
        <field name="perm_unlink" eval="False"/>
    </record>

    <!-- Portal Access Rules for Stock Move -->
    <record id="stock_move_rule_portal" model="ir.rule">
        <field name="name">Portal Personal Delivery Moves</field>
        <field name="model_id" ref="stock.model_stock_move"/>
        <field name="domain_force">[
            ('picking_id.partner_id', 'child_of', [user.commercial_partner_id.id]),
            ('picking_id.picking_type_id.code', '=', 'outgoing'),
            ('picking_id.state', '=', 'done')
        ]</field>
        <field name="groups" eval="[(4, ref('base.group_portal'))]"/>
        <field name="perm_read" eval="True"/>
        <field name="perm_write" eval="False"/>
        <field name="perm_create" eval="False"/>
        <field name="perm_unlink" eval="False"/>
    </record>

    <!-- Portal Access Rules for Stock Move Line -->
    <record id="stock_move_line_rule_portal" model="ir.rule">
        <field name="name">Portal Personal Delivery Move Lines</field>
        <field name="model_id" ref="stock.model_stock_move_line"/>
        <field name="domain_force">[
            ('picking_id.partner_id', 'child_of', [user.commercial_partner_id.id]),
            ('picking_id.picking_type_id.code', '=', 'outgoing'),
            ('picking_id.state', '=', 'done')
        ]</field>
        <field name="groups" eval="[(4, ref('base.group_portal'))]"/>
        <field name="perm_read" eval="True"/>
        <field name="perm_write" eval="False"/>
        <field name="perm_create" eval="False"/>
        <field name="perm_unlink" eval="False"/>
    </record>

</odoo>

